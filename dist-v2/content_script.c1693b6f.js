!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},o={},i=n.parcelRequire2f33;null==i&&((i=function(e){if(e in r)return r[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},n.parcelRequire2f33=i),i.register("450wW",(function(t,n){var r,o;e(t.exports,"register",(function(){return r}),(function(e){return r=e})),e(t.exports,"resolve",(function(){return o}),(function(e){return o=e}));var i={};r=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)i[t[n]]=e[t[n]]},o=function(e){var t=i[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),i.register("6y9qn",(function(e,t){e.exports=i("jnSXm").getBundleURL("9hkNq")+i("450wW").resolve("87JfB")})),i.register("jnSXm",(function(t,n){var r;e(t.exports,"getBundleURL",(function(){return r}),(function(e){return r=e}));var o={};function i(e){return(""+e).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}r=function(e){var t=o[e];return t||(t=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return i(e[2])}return"/"}(),o[e]=t),t}})),i.register("h8MQ8",(function(e,t){e.exports=i("jnSXm").getBundleURL("9hkNq")+i("450wW").resolve("jH34l")})),i("450wW").register(JSON.parse('{"9hkNq":"content_script.c1693b6f.js","87JfB":"textAreaOverlay.047801a6.png","jH34l":"textAreaOverlayHovered.cb8904ec.png","h2B7w":"content_script.a034b753.js"}'));var s=i("bJuUF"),a=i("7l6ej"),c=i("7Fme4"),l=i("7UjPA");var u=i("7s9HL");console.log("very start of content script");var f=new WeakMap;function d(e){var t=f.get(e);void 0!==t&&(e.removeEventListener("keydown",t,!0),f.delete(e))}function p(e){return{"aria-description":e.getAttribute("aria-description"),spellcheck:e.getAttribute("spellcheck")}}var v=new Map;function h(e,t){if(e.removeEventListener("click",b),e.removeEventListener("keydown",m),t){u.compatibleStorage.sync.set({welcomeMessageDismissed:!0})}e.classList.remove("stack-overflow-indentation-plus-plus-welcome-overlay"),function(e){var t=v.get(e);t?(null===t["aria-description"]?e.removeAttribute("aria-description"):e.setAttribute("aria-description",t["aria-description"]),null===t.spellcheck?e.removeAttribute("spellcheck"):e.setAttribute("spellcheck",t.spellcheck)):console.warn("Tried to remove initial attributes from text area, but textarea not found in map")}(e)}function m(e){h(this,!0),this.removeEventListener("click",b)}function b(e){h(this,!0),this.removeEventListener("keydown",m)}document.querySelectorAll("textarea").forEach((function(e){v.set(e,p(e))}));var g=new MutationObserver((function(e){e.forEach((function(e){var t=e.target;if(function(e){return e.nodeType===Node.ELEMENT_NODE}(t)){var n=Array.from(t.querySelectorAll("textarea"));n.forEach((function(e){"comment"===e.name||"Use comments to ask for clarification or add more information. Avoid answering questions in comments."===e.placeholder||e.closest("comment-form")||v.set(e,p(e))})),n.length>0&&y(A)}}))}));function y(e){var t;t={type:"set_active",text:e.functionalityDisabled?"off":"on"},"undefined"==typeof browser?chrome.runtime.sendMessage(t):browser.runtime.sendMessage(t),v.forEach((function(t,n){var r;e.functionalityDisabled?(d(n),h(n,!1),n.classList.remove("stack-exchange-indendation-plus-plus-bordered")):(e.welcomeMessageDismissed?h(n,!1):(n.classList.add("stack-overflow-indentation-plus-plus-welcome-overlay"),n.spellcheck=!1,n.setAttribute("aria-description","Textarea with an overlay welcome message from the Stack Overflow ++ extension. Any keyboard or mouse interaction will permanently dismiss this overlay. Overlay contains an image with text that welcomes you to the extension, instructs you that tabbing will indent one or more lines and shift-tabbing will de-indent, and notes that you can use the extension's toolbar action to change various settings (such as the number of spaces per tab). Interact to dismiss, and I hope you enjoy the extension!"),n.addEventListener("click",b,{once:!0}),n.addEventListener("keydown",m,{once:!0})),null===(r=e.textAreaBorderEnabled)||void 0===r||r?n.classList.add("stack-exchange-indendation-plus-plus-bordered"):n.classList.remove("stack-exchange-indendation-plus-plus-bordered"),function(e){d(e);var t,n=(t=(null==A?void 0:A.numberOfSpacesPerTab)||4,function(e){var n,r,o,i,s=" ".repeat(t),a=0;"Tab"===e.key&&(e.stopPropagation(),e.preventDefault(),r=this.selectionStart,o=this.selectionEnd,n=this.value.substring(r,o),i=this.value,~n.indexOf("\n")?(e.shiftKey?(n=n.split("\n").map((function(e){return e.substr(0,s.length)==s?e.substr(4):e})).join("\n"),this.value=i.substr(0,r)+n+i.substr(o)):(n=n.split("\n").map((function(e){return s+e})).join("\n"),this.value=i.substr(0,r)+n+i.substr(o)),this.selectionStart=r,this.selectionEnd=r+n.length):(e.shiftKey?i.substr(r-s.length,s.length)==s&&(this.value=i.substr(0,r-s.length)+i.substr(o),a=-s.length):(this.value=i.substr(0,r)+s+i.substr(o),a=s.length),this.selectionStart=this.selectionEnd=r+a))});f.set(e,n),e.addEventListener("keydown",n,!0)}(n))}))}var w,k,x=function(e){return"undefined"==typeof browser?e:browser.runtime.getURL(e)},E=x(i("6y9qn")),L=x(i("h8MQ8"));w="\n  textarea.stack-overflow-indentation-plus-plus-welcome-overlay, textarea.stack-overflow-indentation-plus-plus-welcome-overlay:focus {\n    background-image: url(".concat(E,"), linear-gradient(to right, #a8c0ff, #3f2b96), url(").concat(L,");\n    color: transparent;\n    background-repeat:no-repeat;\n    background-position: center center;\n    cursor: pointer;\n  }\n  \n  textarea.stack-overflow-indentation-plus-plus-welcome-overlay:hover {\n    background-image: url(").concat(L,"), linear-gradient(to right, #a8c0ff, #3f2b96);\n  } \n"),(k=document.createElement("style")).textContent=w,document.head.append(k);var A={};function S(){return(S=(0,s.default)(t(l).mark((function e(){var n;return t(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.compatibleStorage.sync.get();case 2:n=e.sent,A=n,console.log("setting up.. ",n),y(A),u.compatibleStorage.onChanged.addListener((function(e,t){if("sync"===t){var n={},r=!0,o=!1,i=void 0;try{for(var s,l=Object.entries(e)[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=(0,c.default)(s.value,2),f=u[0],d=u[1];n[f]=d.newValue}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}y(A=(0,a.default)({},A,n))}})),g.observe(document.body,{childList:!0,subtree:!0});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}console.log("about to setup.."),function(){S.apply(this,arguments)}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTJDbUMsRUFBQW5DLFFBQUFFLFFBQUFrQyxPQUFBRCxFQUMzQyxFQUVBRSxFQUFVSCxFQUFBOUcsRUFBQSxVQWVOa0gsRUFBK0JKLEVBQUE5RyxFQUFBLFVBeEI4QzRHLEVBc0NsRSx1S0FBS08sT0FBQUYsRUFBQSx3REFBQUUsT0FBQUQsRUFBQSw4T0FBQUMsT0FBQUQsRUFBQSw0REF0QzBHTCxFQUFBTyxTQUFBQyxjQUFBLFUsY0FFeEhELFNBQUFFLEtBQUFDLE9BQUFWLEcsTUFzQ3VCLEcseUVBZ0JoQlcsRUFBQUMsR0FBQUMsTUFBQSxTQUFBQyxHLGdCQUNEQyxLQUFBRCxFQUFXRSxNLHVCQURWdkYsRUFBQUMsa0JBQXdCQyxLQUFBZixNLGdEQUF4QnFHLEcsRUFBd0J2RCxHLCtFQUF4QixFLHFHQUlMLElBQUF3RCxHQUFBLEVBQUFDLEVBQUFDLFNBQWdCQyxFQUFBMUgsTUFBQSxHQUFBMkgsRUFBSUosRUFBQSxHQUFBSyxFQUFBTCxFQUFZLEdBQ2hDTSxFQUFBRixHQUFBQyxFQUFBRSxRQUNGLEMsQ0FFRixNQUFBN0gsR0FDQThILEdBQUEsRUFDQUMsRUFBQS9ILENBQW9DLFNBQWlCLElBQWdCZ0ksR0FBQSxNQUFBQyxFQUFBQyxRLFVBNUIxRCxDLG9CQUFBLEMsR0ErQmZwRSxHQUFPLEVBQUFxRSxFQUFBWCxTQUFBLEdBQUExRCxFQUFBOEQsRyx1S0FsQldRLE1BQUExRixLQUFBMkYsVSIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL0BwYXJjZWwvcnVudGltZS1qcy9saWIvaGVscGVycy9idW5kbGUtbWFuaWZlc3QuanMiLCJub2RlX21vZHVsZXMvQHBhcmNlbC9ydW50aW1lLWpzL2xpYi9ydW50aW1lLWIwYjA3NzVjMjZjNmFjN2MuanMiLCJub2RlX21vZHVsZXMvQHBhcmNlbC9ydW50aW1lLWpzL2xpYi9oZWxwZXJzL2J1bmRsZS11cmwuanMiLCJub2RlX21vZHVsZXMvQHBhcmNlbC9ydW50aW1lLWpzL2xpYi9ydW50aW1lLWQyYThmYmMxOTNiYTBmYjUuanMiLCJub2RlX21vZHVsZXMvQHBhcmNlbC9ydW50aW1lLWpzL2xpYi9ydW50aW1lLTg2MGYwNTY1NDZjZTI0OTcuanMiLCJzcmMvY29udGVudF9zY3JpcHQudHMiLCJzcmMvUnVudGltZU1lc3NhZ2UudHMiLCJzcmMvdGV4dGFyZWFEZXYudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtYXBwaW5nID0ge307XG5cbmZ1bmN0aW9uIHJlZ2lzdGVyKHBhaXJzKSB7XG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXMocGFpcnMpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIG1hcHBpbmdba2V5c1tpXV0gPSBwYWlyc1trZXlzW2ldXTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZXNvbHZlKGlkKSB7XG4gIHZhciByZXNvbHZlZCA9IG1hcHBpbmdbaWRdO1xuXG4gIGlmIChyZXNvbHZlZCA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgcmVzb2x2ZSBidW5kbGUgd2l0aCBpZCAnICsgaWQpO1xuICB9XG5cbiAgcmV0dXJuIHJlc29sdmVkO1xufVxuXG5tb2R1bGUuZXhwb3J0cy5yZWdpc3RlciA9IHJlZ2lzdGVyO1xubW9kdWxlLmV4cG9ydHMucmVzb2x2ZSA9IHJlc29sdmU7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2hlbHBlcnMvYnVuZGxlLXVybCcpLmdldEJ1bmRsZVVSTCgnOWhrTnEnKSArIHJlcXVpcmUoJy4vaGVscGVycy9idW5kbGUtbWFuaWZlc3QnKS5yZXNvbHZlKFwiODdKZkJcIik7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBidW5kbGVVUkwgPSB7fTtcblxuZnVuY3Rpb24gZ2V0QnVuZGxlVVJMQ2FjaGVkKGlkKSB7XG4gIHZhciB2YWx1ZSA9IGJ1bmRsZVVSTFtpZF07XG5cbiAgaWYgKCF2YWx1ZSkge1xuICAgIHZhbHVlID0gZ2V0QnVuZGxlVVJMKCk7XG4gICAgYnVuZGxlVVJMW2lkXSA9IHZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG5mdW5jdGlvbiBnZXRCdW5kbGVVUkwoKSB7XG4gIHRyeSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHZhciBtYXRjaGVzID0gKCcnICsgZXJyLnN0YWNrKS5tYXRjaCgvKGh0dHBzP3xmaWxlfGZ0cHwoY2hyb21lfG1venxzYWZhcmktd2ViKS1leHRlbnNpb24pOlxcL1xcL1teKVxcbl0rL2cpO1xuXG4gICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgIC8vIFRoZSBmaXJzdCB0d28gc3RhY2sgZnJhbWVzIHdpbGwgYmUgdGhpcyBmdW5jdGlvbiBhbmQgZ2V0QnVuZGxlVVJMQ2FjaGVkLlxuICAgICAgLy8gVXNlIHRoZSAzcmQgb25lLCB3aGljaCB3aWxsIGJlIGEgcnVudGltZSBpbiB0aGUgb3JpZ2luYWwgYnVuZGxlLlxuICAgICAgcmV0dXJuIGdldEJhc2VVUkwobWF0Y2hlc1syXSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuICcvJztcbn1cblxuZnVuY3Rpb24gZ2V0QmFzZVVSTCh1cmwpIHtcbiAgcmV0dXJuICgnJyArIHVybCkucmVwbGFjZSgvXigoPzpodHRwcz98ZmlsZXxmdHB8KGNocm9tZXxtb3p8c2FmYXJpLXdlYiktZXh0ZW5zaW9uKTpcXC9cXC8uKylcXC9bXi9dKyQvLCAnJDEnKSArICcvJztcbn0gLy8gVE9ETzogUmVwbGFjZSB1c2VzIHdpdGggYG5ldyBVUkwodXJsKS5vcmlnaW5gIHdoZW4gaWUxMSBpcyBubyBsb25nZXIgc3VwcG9ydGVkLlxuXG5cbmZ1bmN0aW9uIGdldE9yaWdpbih1cmwpIHtcbiAgdmFyIG1hdGNoZXMgPSAoJycgKyB1cmwpLm1hdGNoKC8oaHR0cHM/fGZpbGV8ZnRwfChjaHJvbWV8bW96fHNhZmFyaS13ZWIpLWV4dGVuc2lvbik6XFwvXFwvW14vXSsvKTtcblxuICBpZiAoIW1hdGNoZXMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ09yaWdpbiBub3QgZm91bmQnKTtcbiAgfVxuXG4gIHJldHVybiBtYXRjaGVzWzBdO1xufVxuXG5leHBvcnRzLmdldEJ1bmRsZVVSTCA9IGdldEJ1bmRsZVVSTENhY2hlZDtcbmV4cG9ydHMuZ2V0QmFzZVVSTCA9IGdldEJhc2VVUkw7XG5leHBvcnRzLmdldE9yaWdpbiA9IGdldE9yaWdpbjsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vaGVscGVycy9idW5kbGUtdXJsJykuZ2V0QnVuZGxlVVJMKCc5aGtOcScpICsgcmVxdWlyZSgnLi9oZWxwZXJzL2J1bmRsZS1tYW5pZmVzdCcpLnJlc29sdmUoXCJqSDM0bFwiKTsiLCJyZXF1aXJlKCcuL2hlbHBlcnMvYnVuZGxlLW1hbmlmZXN0JykucmVnaXN0ZXIoSlNPTi5wYXJzZShcIntcXFwiOWhrTnFcXFwiOlxcXCJjb250ZW50X3NjcmlwdC5IQVNIX1JFRl82YzE1ZDU0Mzc3OGU2ZDY5LmpzXFxcIixcXFwiODdKZkJcXFwiOlxcXCJ0ZXh0QXJlYU92ZXJsYXkuSEFTSF9SRUZfNWVhMjE0MDYwZWI1ZmJiZS5wbmdcXFwiLFxcXCJqSDM0bFxcXCI6XFxcInRleHRBcmVhT3ZlcmxheUhvdmVyZWQuSEFTSF9SRUZfZTU2NDY5ZWU0YWQ5OWFiNy5wbmdcXFwiLFxcXCJoMkI3d1xcXCI6XFxcImNvbnRlbnRfc2NyaXB0LkhBU0hfUkVGX2M2N2Y2YWUyNWZjODMwNWYuanNcXFwifVwiKSk7IiwiY29uc29sZS5sb2coXCJ2ZXJ5IHN0YXJ0IG9mIGNvbnRlbnQgc2NyaXB0XCIpXHJcblxyXG5pbXBvcnQgeyBzZW5kVHlwZWRNZXNzYWdlIH0gZnJvbSBcIi4vUnVudGltZU1lc3NhZ2VcIjtcclxuaW1wb3J0IFN0b3JhZ2VNb2RhbCBmcm9tIFwiLi9TdG9yYWdlTW9kYWxcIjtcclxuaW1wb3J0IHRleHRhcmVhRGV2IGZyb20gXCIuL3RleHRhcmVhRGV2XCI7XHJcblxyXG5pbXBvcnQgeyBjb21wYXRpYmxlU3RvcmFnZSBhcyBzdG9yYWdlIH0gZnJvbSBcIi4vdjItdjMtYWJzdHJhY3Rpb25zXCI7XHJcblxyXG5jb25zdCBjdXJyZW50bHlFbnJpY2hlZDogV2Vha01hcDxIVE1MVGV4dEFyZWFFbGVtZW50LCAodGhpczogSFRNTFRleHRBcmVhRWxlbWVudCwgZTogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZD4gPSBuZXcgV2Vha01hcCgpXHJcblxyXG5mdW5jdGlvbiBlbnJpY2hXaXRoSW5kZW50YXRpb24odGV4dEFyZWE6IEhUTUxUZXh0QXJlYUVsZW1lbnQpIHtcclxuXHJcbiAgICAvLyByZW1vdmUgYW55IHBhc3QgZW5yaWNobWVudFxyXG4gICAgcmVtb3ZlSW5kZW50YXRpb25FbnJpY2htZW50KHRleHRBcmVhKVxyXG5cclxuICAgIGNvbnN0IGxpc3RlbmVyID0gdGV4dGFyZWFEZXYoc3RvcmFnZVN0YXRlPy5udW1iZXJPZlNwYWNlc1BlclRhYiB8fCA0KVxyXG4gICAgY3VycmVudGx5RW5yaWNoZWQuc2V0KHRleHRBcmVhLCBsaXN0ZW5lcilcclxuXHJcbiAgICB0ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBsaXN0ZW5lciwgdHJ1ZSlcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlSW5kZW50YXRpb25FbnJpY2htZW50KHRleHRBcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50KSB7XHJcbiAgICBcclxuICAgIGNvbnN0IHByZXhpc3RpbmdMaXN0ZW5lciA9IGN1cnJlbnRseUVucmljaGVkLmdldCh0ZXh0QXJlYSlcclxuXHJcbiAgICBpZihwcmV4aXN0aW5nTGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHRleHRBcmVhLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHByZXhpc3RpbmdMaXN0ZW5lciwgdHJ1ZSlcclxuICAgICAgICBjdXJyZW50bHlFbnJpY2hlZC5kZWxldGUodGV4dEFyZWEpXHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5vZGVJc0VsZW1lbnQobm9kZTogTm9kZSk6IG5vZGUgaXMgRWxlbWVudCB7XHJcbiAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREVcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlc3RvcmUgdGhlIGluaXRpYWwgYXR0cmlidXRlcyB0byBhIFRleHRBcmVhIGFmdGVyIHdlIHJlbW92ZSB0aGUgb3ZlcmxheVxyXG4gKi9cclxuZnVuY3Rpb24gcmVzdG9yZUluaXRpYWxBdHRyaWJ1dGVzKHRleHRBcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50KSB7XHJcblxyXG4gICAgY29uc3QgaW5pdGlhbEF0dHJpYnV0ZXMgPSB0ZXh0QXJlYXMuZ2V0KHRleHRBcmVhKVxyXG5cclxuICAgIGlmKCFpbml0aWFsQXR0cmlidXRlcykge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcIlRyaWVkIHRvIHJlbW92ZSBpbml0aWFsIGF0dHJpYnV0ZXMgZnJvbSB0ZXh0IGFyZWEsIGJ1dCB0ZXh0YXJlYSBub3QgZm91bmQgaW4gbWFwXCIpXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgaWYoaW5pdGlhbEF0dHJpYnV0ZXNbXCJhcmlhLWRlc2NyaXB0aW9uXCJdID09PSBudWxsKSB7XHJcbiAgICAgICAgdGV4dEFyZWEucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1kZXNjcmlwdGlvblwiKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0ZXh0QXJlYS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWRlc2NyaXB0aW9uXCIsIGluaXRpYWxBdHRyaWJ1dGVzW1wiYXJpYS1kZXNjcmlwdGlvblwiXSlcclxuICAgIH1cclxuXHJcbiAgICBpZihpbml0aWFsQXR0cmlidXRlcy5zcGVsbGNoZWNrID09PSBudWxsKSB7XHJcbiAgICAgICAgdGV4dEFyZWEucmVtb3ZlQXR0cmlidXRlKFwic3BlbGxjaGVja1wiKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0ZXh0QXJlYS5zZXRBdHRyaWJ1dGUoXCJzcGVsbGNoZWNrXCIsIGluaXRpYWxBdHRyaWJ1dGVzLnNwZWxsY2hlY2spXHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDYXB0dXJlIHRoZSBpbml0aWFsIChyZWxldmFudCkgYXR0cmJpdXRlcyBmcm9tIGEgdGV4dCBhcmVhIGJlZm9yZSB3ZSBhcHBseSB0aGUgb3ZlcmxheVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0SW5pdGlhbEF0dHJpYnV0ZXModGV4dEFyZWE6IEhUTUxUZXh0QXJlYUVsZW1lbnQpOiBJbml0YWxUZXh0QXJlYUF0dHJpYnV0ZXMge1xyXG4gICAgXHJcbiAgICBjb25zdCBleGlzdGluZ0FyaWFEZXNjcmlwdGlvbiA9IHRleHRBcmVhLmdldEF0dHJpYnV0ZShcImFyaWEtZGVzY3JpcHRpb25cIilcclxuICAgIGNvbnN0IGV4aXN0aW5nU3BlbGxjaGVjayA9IHRleHRBcmVhLmdldEF0dHJpYnV0ZShcInNwZWxsY2hlY2tcIilcclxuXHJcbiAgICByZXR1cm4ge1wiYXJpYS1kZXNjcmlwdGlvblwiOiBleGlzdGluZ0FyaWFEZXNjcmlwdGlvbiwgc3BlbGxjaGVjazogZXhpc3RpbmdTcGVsbGNoZWNrfVxyXG59XHJcblxyXG5pbnRlcmZhY2UgSW5pdGFsVGV4dEFyZWFBdHRyaWJ1dGVzIHtcclxuICAgIFwiYXJpYS1kZXNjcmlwdGlvblwiOiBzdHJpbmcgfCBudWxsXHJcbiAgICBzcGVsbGNoZWNrOiBzdHJpbmcgfCBudWxsXHJcbn1cclxuXHJcbmNvbnN0IHRleHRBcmVhczogTWFwPEhUTUxUZXh0QXJlYUVsZW1lbnQsIEluaXRhbFRleHRBcmVhQXR0cmlidXRlcz4gPSBuZXcgTWFwKClcclxuXHJcbi8vIEluaXRpYWxpemUgYWxsIHRoZSB0ZXh0IGFyZWFzIHdlIHNlZSBhZnRlciBsb2FkXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJ0ZXh0YXJlYVwiKS5mb3JFYWNoKHByZWV4aXN0aW5nVGV4dEFyZWEgPT4ge1xyXG4gICAgdGV4dEFyZWFzLnNldChwcmVleGlzdGluZ1RleHRBcmVhLCBnZXRJbml0aWFsQXR0cmlidXRlcyhwcmVleGlzdGluZ1RleHRBcmVhKSlcclxufSlcclxuXHJcbmZ1bmN0aW9uIHJlbW92ZU92ZXJsYXkodGV4dEFyZWE6IEhUTUxUZXh0QXJlYUVsZW1lbnQsIHJlbW92ZVBlcm1lbmFudGx5OiBib29sZWFuKSB7XHJcblxyXG4gICAgdGV4dEFyZWEucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbGljaylcclxuICAgIHRleHRBcmVhLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZU92ZXJsYXlLZXlEb3duKVxyXG5cclxuICAgIGlmKHJlbW92ZVBlcm1lbmFudGx5KSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3Qgc3RhdGVVcGRhdGU6IFBhcnRpYWw8U3RvcmFnZU1vZGFsPiA9IHtcclxuICAgICAgICAgICAgd2VsY29tZU1lc3NhZ2VEaXNtaXNzZWQ6IHRydWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHN0b3JhZ2Uuc3luYy5zZXQoc3RhdGVVcGRhdGUpXHJcbiAgICB9XHJcblxyXG4gICAgdGV4dEFyZWEuY2xhc3NMaXN0LnJlbW92ZShcInN0YWNrLW92ZXJmbG93LWluZGVudGF0aW9uLXBsdXMtcGx1cy13ZWxjb21lLW92ZXJsYXlcIilcclxuICAgIHJlc3RvcmVJbml0aWFsQXR0cmlidXRlcyh0ZXh0QXJlYSlcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlT3ZlcmxheUtleURvd24odGhpczogSFRNTFRleHRBcmVhRWxlbWVudCwgZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcclxuICAgIHJlbW92ZU92ZXJsYXkodGhpcywgdHJ1ZSlcclxuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbGljaylcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlT3ZlcmxheUNsaWNrKHRoaXM6IEhUTUxUZXh0QXJlYUVsZW1lbnQsIGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICByZW1vdmVPdmVybGF5KHRoaXMsIHRydWUpXHJcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZU92ZXJsYXlLZXlEb3duKVxyXG59XHJcblxyXG52YXIgZG9tT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zKSB7XHJcblxyXG4gICAgbXV0YXRpb25zLmZvckVhY2goIG11dGF0aW9uID0+IHtcclxuXHJcbiAgICAgICAgY29uc3Qgbm9kZSA9IG11dGF0aW9uLnRhcmdldFxyXG5cclxuICAgICAgICBpZihub2RlSXNFbGVtZW50KG5vZGUpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1RleHRFbGVtZW50cyA9IEFycmF5LmZyb20obm9kZS5xdWVyeVNlbGVjdG9yQWxsKFwidGV4dGFyZWFcIikpO1xyXG5cclxuICAgICAgICAgICAgbmV3VGV4dEVsZW1lbnRzLmZvckVhY2gobmV3VGV4dEFyZWEgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGJsYWNrbGlzdCBjb21tZW50cywgZm9yIG5vdy4gV2UgbWF5IHdhbnQgdG8gd2hpdGVsaXN0IG90aGVyIHN0dWZmIGluc3RlYWQsIGxhdGVyXHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc0NvbW1lbnQgPVxyXG4gICAgICAgICAgICAgICAgICAgIG5ld1RleHRBcmVhLm5hbWUgPT09IFwiY29tbWVudFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfHwgbmV3VGV4dEFyZWEucGxhY2Vob2xkZXIgPT09IFwiVXNlIGNvbW1lbnRzIHRvIGFzayBmb3IgY2xhcmlmaWNhdGlvbiBvciBhZGQgbW9yZSBpbmZvcm1hdGlvbi4gQXZvaWQgYW5zd2VyaW5nIHF1ZXN0aW9ucyBpbiBjb21tZW50cy5cIlxyXG4gICAgICAgICAgICAgICAgICAgIHx8IG5ld1RleHRBcmVhLmNsb3Nlc3QoXCJjb21tZW50LWZvcm1cIilcclxuXHJcbiAgICAgICAgICAgICAgICBpZighaXNDb21tZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFyZWFzLnNldChuZXdUZXh0QXJlYSwgZ2V0SW5pdGlhbEF0dHJpYnV0ZXMobmV3VGV4dEFyZWEpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIGlmKG5ld1RleHRFbGVtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhcHBseURvbU1vZGlmaWNhdGlvbnMoc3RvcmFnZVN0YXRlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gYXBwbHlEb21Nb2RpZmljYXRpb25zKGV4aXN0aW5nU3RhdGU6IFN0b3JhZ2VNb2RhbCkge1xyXG5cclxuICAgIC8vIHRlbGwgdGhlIGJhY2tncm91bmQgcnVubmVyIHRoYXQgd2UncmUgYWN0aXZlLCBzbyBpdCBjYW4gY2hhbmdlIHRoZSBiYWRnZSB0ZXh0XHJcbiAgICBzZW5kVHlwZWRNZXNzYWdlKHt0eXBlOiBcInNldF9hY3RpdmVcIiwgdGV4dDogZXhpc3RpbmdTdGF0ZS5mdW5jdGlvbmFsaXR5RGlzYWJsZWQgPyBcIm9mZlwiIDogXCJvblwifSlcclxuXHJcbiAgICB0ZXh0QXJlYXMuZm9yRWFjaCgoaW5pdGlhbEF0dHJpYnV0ZXMsIHRleHRBcmVhKSA9PiB7XHJcblxyXG5cclxuICAgICAgICBpZihleGlzdGluZ1N0YXRlLmZ1bmN0aW9uYWxpdHlEaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZW1vdmVJbmRlbnRhdGlvbkVucmljaG1lbnQodGV4dEFyZWEpXHJcbiAgICAgICAgICAgIHJlbW92ZU92ZXJsYXkodGV4dEFyZWEsIGZhbHNlKVxyXG4gICAgICAgICAgICB0ZXh0QXJlYS5jbGFzc0xpc3QucmVtb3ZlKFwic3RhY2stZXhjaGFuZ2UtaW5kZW5kYXRpb24tcGx1cy1wbHVzLWJvcmRlcmVkXCIpXHJcbiAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgIC8vIG5vdCBkaXNhYmxlZCwgc28gd2UgYXBwbHkgYWxsIG91ciBtb2RpZmljYXRpb24gYmFzZWQgb24gb3RoZXIgc2V0dGluZ3NcclxuXHJcbiAgICAgICAgICAgIGlmKGV4aXN0aW5nU3RhdGUud2VsY29tZU1lc3NhZ2VEaXNtaXNzZWQpIHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZU92ZXJsYXkodGV4dEFyZWEsIGZhbHNlKVxyXG4gICAgICAgICAgICB9IGVsc2UgeyAvLyBmaXJzdCB0aW1lIGFmdGVyIGluc3RhbGxcclxuXHJcbiAgICAgICAgICAgICAgICB0ZXh0QXJlYS5jbGFzc0xpc3QuYWRkKFwic3RhY2stb3ZlcmZsb3ctaW5kZW50YXRpb24tcGx1cy1wbHVzLXdlbGNvbWUtb3ZlcmxheVwiKVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBzdG9yZSB2YXJpb3VzIHNldHRpbmdzLCBzcGVsbGNoZWNrIGFuZCBhcmlhIFxyXG4gICAgICAgICAgICAgICAgdGV4dEFyZWEuc3BlbGxjaGVjayA9IGZhbHNlXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gTWlnaHQgbm90IGJlIG5lZWRlZCwgYXMgdGhlIGJhY2tncm91bmQgd291bGQgbGlrZWx5IGJlIGlnbm9yZWQgYnkgc2NyZWVuIHJlYWRlcnNcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IGZpbmQgaWYgdGhpcyBpcyBhIHVzZWZ1bCBhY2Nlc3NpYmlsaXR5IHNldHRpbmcsIG9yIHVzZWxlc3MvZGV0cmltZW50YWxcclxuICAgICAgICAgICAgICAgIHRleHRBcmVhLnNldEF0dHJpYnV0ZShcImFyaWEtZGVzY3JpcHRpb25cIiwgXCJUZXh0YXJlYSB3aXRoIGFuIG92ZXJsYXkgd2VsY29tZSBtZXNzYWdlIGZyb20gdGhlIFN0YWNrIE92ZXJmbG93ICsrIGV4dGVuc2lvbi5cIiArIFxyXG4gICAgICAgICAgICAgICAgXCIgQW55IGtleWJvYXJkIG9yIG1vdXNlIGludGVyYWN0aW9uIHdpbGwgcGVybWFuZW50bHkgZGlzbWlzcyB0aGlzIG92ZXJsYXkuIE92ZXJsYXkgY29udGFpbnMgYW4gaW1hZ2Ugd2l0aCB0ZXh0IHRoYXRcIiArXHJcbiAgICAgICAgICAgICAgICBcIiB3ZWxjb21lcyB5b3UgdG8gdGhlIGV4dGVuc2lvbiwgaW5zdHJ1Y3RzIHlvdSB0aGF0IHRhYmJpbmcgd2lsbCBpbmRlbnQgb25lIG9yIG1vcmUgbGluZXMgYW5kIHNoaWZ0LXRhYmJpbmcgd2lsbCBkZS1pbmRlbnQsXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgYW5kIG5vdGVzIHRoYXQgeW91IGNhbiB1c2UgdGhlIGV4dGVuc2lvbidzIHRvb2xiYXIgYWN0aW9uIHRvIGNoYW5nZSB2YXJpb3VzIHNldHRpbmdzIChzdWNoIGFzIHRoZSBudW1iZXJcIiArXHJcbiAgICAgICAgICAgICAgICBcIiBvZiBzcGFjZXMgcGVyIHRhYikuIEludGVyYWN0IHRvIGRpc21pc3MsIGFuZCBJIGhvcGUgeW91IGVuam95IHRoZSBleHRlbnNpb24hXCIpXHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGVhY2ggbGlzdGVuZXIgd2lsbCBmaXJlIG9uY2UsIGFuZCB3aGVuIGZpcmVkIHdpbGwgcmVtb3ZlIHRoZSBvdGhlciBsaXN0bmVyIHRoYXQgd2Fzbid0IGZpcmVkXHJcbiAgICAgICAgICAgICAgICB0ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheUNsaWNrLCB7b25jZTogdHJ1ZX0pXHJcbiAgICAgICAgICAgICAgICB0ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVPdmVybGF5S2V5RG93biwge29uY2U6IHRydWV9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZihleGlzdGluZ1N0YXRlLnRleHRBcmVhQm9yZGVyRW5hYmxlZCA/PyB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0QXJlYS5jbGFzc0xpc3QuYWRkKFwic3RhY2stZXhjaGFuZ2UtaW5kZW5kYXRpb24tcGx1cy1wbHVzLWJvcmRlcmVkXCIpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0QXJlYS5jbGFzc0xpc3QucmVtb3ZlKFwic3RhY2stZXhjaGFuZ2UtaW5kZW5kYXRpb24tcGx1cy1wbHVzLWJvcmRlcmVkXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGVucmljaFdpdGhJbmRlbnRhdGlvbih0ZXh0QXJlYSlcclxuICAgICAgICB9XHJcblxyXG4gICAgfSlcclxuICAgIFxyXG59XHJcblxyXG4vKipcclxuICogVXRpbGl0eSBmdW5jdGlvbiB0byBhZGQgQ1NTIGluIG11bHRpcGxlIHBhc3Nlcy5cclxuICogQHBhcmFtIHtzdHJpbmd9IHN0eWxlU3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBhZGRTdHlsZShzdHlsZVN0cmluZzogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XHJcbiAgICBzdHlsZS50ZXh0Q29udGVudCA9IHN0eWxlU3RyaW5nO1xyXG4gICAgZG9jdW1lbnQuaGVhZC5hcHBlbmQoc3R5bGUpO1xyXG59XHJcblxyXG4vLyBpdCBzZWVtcyBsaWtlIGZvciBtYW5pZmVzdCAzLCB0aGUgYnVuZGxlciBhdXRvbWF0aWNhbGx5IGdldHMgdGhlIHVybCBvbiBgcmVxdWlyZWAsIGJ1dCBvbmx5IGdpdmVzIHRoZSBmaWxlIHBhdGggZm9yIG1hbmlmZXN0IDIuIFN0cmFuZ2UuXHJcbmNvbnN0IGNvbXBhdGlibGVHZXRVUkwgPSAocGF0aE9yVXJsOiBzdHJpbmcpID0+IHR5cGVvZiBicm93c2VyID09PSBcInVuZGVmaW5lZFwiID8gcGF0aE9yVXJsIDogYnJvd3Nlci5ydW50aW1lLmdldFVSTChwYXRoT3JVcmwpXHJcblxyXG5jb25zdCB0ZXh0QXJlYU92ZXJsYXlVcmwgPSBjb21wYXRpYmxlR2V0VVJMKHJlcXVpcmUoXCIuLi9pbWFnZXMvdGV4dEFyZWFPdmVybGF5LnBuZ1wiKSlcclxuY29uc3QgdGV4dEFyZWFPdmVybGF5SG92ZXJVcmwgPSBjb21wYXRpYmxlR2V0VVJMKHJlcXVpcmUoXCIuLi9pbWFnZXMvdGV4dEFyZWFPdmVybGF5SG92ZXJlZC5wbmdcIikpXHJcblxyXG4vLyB3ZSBuZWVkIHRvIGdldCB0aGUgaW1hZ2UgdXJsIGZyb20gdGhlIHJ1bnRpbWUsIHNvIHdlIGNhbid0IGRlZmluZSB0aGlzIGluIG91ciBjc3MgZmlsZVxyXG4vLyBpbnN0ZWFkLCB3ZSBqdXN0IGluamVjdCBpdCBpbnRvIHRoZSBoZWFkXHJcbi8vIHdlIGFkZCBib3RoIGltYWdlcyBpbiB0aGUgYmFja2dyb3VuZC1pbWFnZSwgYnV0IHRoZSBsYXRlciB3aWxsIGJlIGhpZGRlbiBieSB0aGUgZ3JhZGllbnRcclxuLy8gaG93ZXZlciwgdGhpcyBlbmZvcmNlcyBpdCBnZXRzIGxvYWRlZCwgc28gdGhhdCB3aGVuIHdlIGhvdmVyIGxhdGVyIHRoaXMgaXMgbm8gZGVsYXlcclxuYWRkU3R5bGUoYFxyXG4gIHRleHRhcmVhLnN0YWNrLW92ZXJmbG93LWluZGVudGF0aW9uLXBsdXMtcGx1cy13ZWxjb21lLW92ZXJsYXksIHRleHRhcmVhLnN0YWNrLW92ZXJmbG93LWluZGVudGF0aW9uLXBsdXMtcGx1cy13ZWxjb21lLW92ZXJsYXk6Zm9jdXMge1xyXG4gICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCR7dGV4dEFyZWFPdmVybGF5VXJsfSksIGxpbmVhci1ncmFkaWVudCh0byByaWdodCwgI2E4YzBmZiwgIzNmMmI5NiksIHVybCgke3RleHRBcmVhT3ZlcmxheUhvdmVyVXJsfSk7XHJcbiAgICBjb2xvcjogdHJhbnNwYXJlbnQ7XHJcbiAgICBiYWNrZ3JvdW5kLXJlcGVhdDpuby1yZXBlYXQ7XHJcbiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXIgY2VudGVyO1xyXG4gICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gIH1cclxuICBcclxuICB0ZXh0YXJlYS5zdGFjay1vdmVyZmxvdy1pbmRlbnRhdGlvbi1wbHVzLXBsdXMtd2VsY29tZS1vdmVybGF5OmhvdmVyIHtcclxuICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgke3RleHRBcmVhT3ZlcmxheUhvdmVyVXJsfSksIGxpbmVhci1ncmFkaWVudCh0byByaWdodCwgI2E4YzBmZiwgIzNmMmI5Nik7XHJcbiAgfSBcclxuYClcclxuXHJcbi8vIFRPRE86IGNlbnRyYWxpemUgZGVmYXVsdHMgZm9yIGhlcmUgYW5kIHBvcHVwXHJcbmxldCBzdG9yYWdlU3RhdGU6IFN0b3JhZ2VNb2RhbCA9IHt9XHJcblxyXG4vKipcclxuICogR2V0IGluaXRhbCBzdGF0ZVxyXG4gKiBcclxuICogYXBwbHkgYWxsIG1vZGlmaWNpYXRpb25zIHRvIHRoZSBkb20gKGhvb2sgaW50byB0ZXh0YXJlYXMgZm9yIGluZGVudGF0aW9uLCBhZGQgYm9yZGVyLCBwb3RlbnRpYWxseSBhZGQgb3ZlcmxheSwgb3IgcmVtb3ZlIGFueSBvZiB0aGVzZSlcclxuICogXHJcbiAqIGxpc3RlbiB0byBhbnkgY2hhbmdlcyBvZiBzeW5jIHN0b3JhZ2VcclxuICogICAgKiBhbmQgcmVhcHBseSBkb20gbW9kaWZpY2F0aW9uc1xyXG4gKiBcclxuICogb2JzZXJ2ZSBuZXcgdGV4dCBhcmVhcyBhZGRlZFxyXG4gKiAgICAqIGFuZCByZWFwcGx5IGRvbSBtb2RpZmljYXRpb25zXHJcbiAqL1xyXG5jb25zb2xlLmxvZyhcImFib3V0IHRvIHNldHVwLi5cIilcclxuYXN5bmMgZnVuY3Rpb24gc2V0dXAoKSB7XHJcblxyXG4gICAgY29uc3QgaW5pdGlhbFN0b3JhZ2VTdGF0ZSA9IGF3YWl0IHN0b3JhZ2Uuc3luYy5nZXQoKVxyXG4gICAgc3RvcmFnZVN0YXRlID0gaW5pdGlhbFN0b3JhZ2VTdGF0ZVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwic2V0dGluZyB1cC4uIFwiLCBpbml0aWFsU3RvcmFnZVN0YXRlKVxyXG5cclxuICAgIGFwcGx5RG9tTW9kaWZpY2F0aW9ucyhzdG9yYWdlU3RhdGUpXHJcblxyXG4gICAgc3RvcmFnZS5vbkNoYW5nZWQuYWRkTGlzdGVuZXIoKGNoYW5nZXMsIGFyZWEpID0+IHtcclxuXHJcbiAgICAgICAgaWYoYXJlYSAhPT0gXCJzeW5jXCIpIHtcclxuICAgICAgICAgICAgLy8gd2Ugb25seSBjYXJlIGFib3V0IHN5bmMgc3RhdGUuIHN0b3JhZ2Uuc3luYy5vbkNoYW5nZWQgZG9lc24ndCBleGlzdCBmb3IgdGhlIFwiYnJvd3NlclwiIG9iamVjdFxyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBjb25zdCBhbGxDaGFuZ2VzOiBQYXJ0aWFsPFN0b3JhZ2VNb2RhbD4gPSB7fVxyXG4gICAgXHJcbiAgICAgICAgZm9yIChjb25zdCBbcHJvcGVydHksIGNoYW5nZV0gb2YgT2JqZWN0LmVudHJpZXMoY2hhbmdlcykpIHtcclxuICAgICAgICAgICAgYWxsQ2hhbmdlc1twcm9wZXJ0eSBhcyBrZXlvZiBTdG9yYWdlTW9kYWxdID0gKGNoYW5nZSBhcyBhbnkpLm5ld1ZhbHVlXHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgc3RvcmFnZVN0YXRlID0gKHsuLi5zdG9yYWdlU3RhdGUsIC4uLmFsbENoYW5nZXN9KVxyXG4gICAgICAgIGFwcGx5RG9tTW9kaWZpY2F0aW9ucyhzdG9yYWdlU3RhdGUpXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIG9ic2VydmUgdGhlIGRvY3VtZW50IGRvY3VtZW50IGJvZHkgZm9yIGNoYW5nZXMuIFdlIGNvdWxkIHByb2JhYmx5IG9ic2VydmUgYSBzbWFsbGVyIHBvcnRpb24gb2YgdGhlIHBhZ2UsXHJcbiAgICAvLyBidXQgdGhpcyB3aWxsIGNhdGNoIGFsbCBjaGFuZ2VzIGFuZCBTdGFjayBPdmVyZmxvdyBpc24ndCBhIGhpZ2hseSBkeW5hbWljIHBhZ2Ugc28gdGhlIGNvc3QgaXMgY2hlYXBcclxuICAgIGRvbU9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge2NoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZX0pO1xyXG59XHJcblxyXG5zZXR1cCgpIiwiXHJcbnR5cGUgUnVudGltZU1lc3NhZ2UgPSB7XHJcbiAgICB0eXBlOiBcInNldF9hY3RpdmVcIixcclxuICAgIHRleHQ6IFwib25cIiB8IFwib2ZmXCJcclxufVxyXG5cclxuLy8gdXNlIGJyb3dzZXIgaWYgaXQgZXhpc3RzIChpbmRpY2F0aW5nIHdlJ3JlIHJ1bm5pbmcgaW4gbWFuaWZlc3QgdjIgaW4gZmlyZWZveCksIG90aGVyd2lzZSB1c2UgY2hyb21lIChmb3IgdjMpXHJcbmV4cG9ydCBjb25zdCBzZW5kVHlwZWRNZXNzYWdlID0gKG1lc3NhZ2U6IFJ1bnRpbWVNZXNzYWdlKSA9PiBcclxuICAgICh0eXBlb2YgYnJvd3NlciA9PT0gXCJ1bmRlZmluZWRcIilcclxuICAgICAgICA/IGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKG1lc3NhZ2UpXHJcbiAgICAgICAgOiBicm93c2VyLnJ1bnRpbWUuc2VuZE1lc3NhZ2UobWVzc2FnZSlcclxuICAgICAgICBcclxuZXhwb3J0IGRlZmF1bHQgUnVudGltZU1lc3NhZ2UiLCIvKipcclxuICogVGhpcyBpcyBzb3VyY2VkIGZyb20gYSBjb2RlcGVuIChodHRwczovL2NvZGVwZW4uaW8vTWVCZWlNL3Blbi9vZ3JtQlAvKSBieSBNYXJjbyBCb25lbGxpIChodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vdXNlcnMvMzg4OTQ0OSlcclxuICogXHJcbiAqIEkgZGlzY292ZXJlZCBpdCBpbiB0aGlzIG1ldGEgc3RhY2sgb3ZlcmZsb3cgcG9zdDogaHR0cHM6Ly9tZXRhLnN0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yOTAwMjYvbWFya2Rvd24tZWRpdG9yLWluZGVudC1hbmQtb3V0ZGVudC1mdW5jdGlvbmFsaXR5XHJcbiAqIFxyXG4gKiBJbiB0aGF0IHBvc3QsIE1hcmNvIHN0YXRlczpcclxuICogPiBJdCdzIGp1c3Qgc2l4dHkgbGluZXMgb2YgY29kZSBzbyBJIGRvbid0IHNlZSB0aGUgbmVlZCBvZiBhbnkgY29weXJpZ2h0L2xpY2Vuc2UvYXR0cmlidXRpb24sIFxyXG4gKiA+IEkganVzdCB3YW50ZWQgdG8gc2hhcmUgaXQgd2l0aCBteSBmZWxsb3cgcHJvZ3JhbW1lcnMgaGVyZSBvbiBTdGFjayBPdmVyZmxvdyA6KVxyXG4gKiBcclxuICogSW4gdGhhdCBzcGlyaXQsIHRoaXMgZmlsZSBpcyBvZmZpY2FsbHkgdW5saWNlbnNlZCwgdGhvdWdoIEkgaGF2ZSBtYWRlIHNvbWUgbW9kaWZpY2F0aW9ucyAodGhlIHJlc3Qgb2YgdGhpcyByZXBvIGlzIE1JVCBsaWNlbnNlZCkuXHJcbiAqIEhvd2V2ZXIsIGlmIHlvdSB1c2UgaXQsIHBsZWFzZSBhdHRyaWJ1dGUgTWFyY28sIGFuZCBvcHRpb25hbGx5IG1lIGlmIHlvdSB1c2UgdGhlIG1vZGlmaWNhdGlvbnMuXHJcbiAqIFxyXG4gKiBUaGFua3MgTWFyY28hXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgSW50UmFuZ2UgfSBmcm9tIFwiLi9UeXBlSGVscGVyc1wiO1xyXG5cclxuLyoqKioqKioqKioqKiAgT3JpZ2luYWwgTm90aWNlLCBzb21lIGFzcGVjdHMgb3V0ZGF0ZWQgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gKiBUaXRsZTogVGV4dGFyZWEgZGV2ZWxvcGVyIFRBQiBrZXkgKGJldGEpXHJcbiAqIEF1dGhvcjogTWFyY28gQm9uZWxsaSAoaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3VzZXJzLzM4ODk0NDkpXHJcbiAqXHJcbiAqIERlc2NyaXB0aW9uOlxyXG4gKiAgIEVuYWJsZXMgZXh0ZW5kZWQgVEFCIGZ1bmN0aW9uYWxpdHkgb24gdGV4dGFyZWFzIG9mIHRoZSBjdXJyZW50IHBhZ2UgZm9yIGluZGVudGluZy9kZWRlbnRpbmcgc2luZ2xlL211bHRpcGxlIGxpbmVzLlxyXG4gKiAgIFRoZSBkZWZhdWx0IGluZGVudGF0aW9uIGlzIDQgc3BhY2VzIChcIiAgICBcIik7IGNoYW5nZSB0aGUgdmFyIFRBQl9DSEFSIGlmIHlvdSB3YW50IHRvIHVzZSBhbm90aGVyIFRBQiBkZWxpbWl0ZXIuXHJcbiAqICAgT3JpZ2luYWxseSBkZXZlbG9wZWQgZm9yIFN0YWNrIE92ZXJmbG93IE1hcmtkb3duIGVkaXRvci5cclxuICpcclxuICogSW1wbGVtZW50YXRpb246XHJcbiAqICAgVXNlICdlbGVtZW50LmVuYWJsZVRleHRhcmVhRGV2KCknIHRvIGVuYWJsZSB0aGUgZmVhdHVyZSBmb3IgYWxsIHRoZSB0ZXh0YXJlYXMgaW5zaWRlIHRoZSBlbGVtZW50IChpbmNsdWRpbmcgdGhlIGVsZW1lbnQgaXRzZWxmKS5cclxuICogICBVc2UgJ2VsZW1lbnQuZGlzYWJsZVRleHRhcmVhRGV2KCknIHRvIGRpc2FibGUgdGhlIHByZXZpb3VzbHkgZW5hYmxlZCBmZWF0dXJlLlxyXG4gKlxyXG4gKiBVc2FnZTpcclxuICogICBTaW5nbGUgbGluZTogcGxhY2UgdGhlIGN1cnNvciB3aGVyZSB5b3Ugd2FudCBhbmQgcHJlc3MgW1RBQl0gdG8gYWRkIGEgdGFiIGNoYXJhY3Rlciwgb3IgW1NISUZUXStbVEFCXSB0byByZW1vdmUgYSBwcmV2aW91c2x5IGluc2VydGVkIHRhYiBjaGFyYWN0ZXIgKGJlZm9yZSB0aGUgY2FyZXQgcG9zaXRpb24pLlxyXG4gKiAgIE11bHRpIGxpbmU6IHNlbGVjdCBtdWx0aXBsZSBsaW5lcyBvZiBjb2RlIGFuZCBwcmVzcyBbVEFCXSB0byBhZGQgYSB0YWIgY2hhcmFjdGVyIGF0IHRoZSBiZWdpbm5pbmcgb2YgZWFjaCBsaW5lLCBvciBbU0hJRlRdK1tUQUJdIHRvIHJlbW92ZSBwcmV2aW91c2x5IGluc2VydGVkIHRhYiBjaGFyYWN0ZXJzLlxyXG4gKlxyXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB0ZXh0YXJlYURldih0YWJMZW5ndGg6IEludFJhbmdlPDEsIDEyPikge1xyXG4gICAgXHJcbiAgICAvLyB0b2RvOiBjb25zaWRlciBjaGVja2luZyBmb3IgZS50YXJnZXQudGFnTmFtZSA9PSAnVEVYVEFSRUEnICh3aGljaCB1c2VkIHRvIGJlIHRoZXJlKSwgb3IgYWRkIHN0cm9uZ2VyIHR5cGluZyB0byBlXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gaW5uZXIodGhpczogSFRNTFRleHRBcmVhRWxlbWVudCwgZTogS2V5Ym9hcmRFdmVudCkge1xyXG5cclxuICAgICAgICBsZXQgVEFCX0NIQVIgPSAnICcucmVwZWF0KHRhYkxlbmd0aCksXHJcbiAgICAgICAgICAgIHNlbGVjdGlvbkRlbHRhID0gMCwgLy8gbm90IHN1cmUgYWJvdXQgdGhlIG5hbWUgb2YgdGhpcywgd2FzIFwiZHNcIiBiZWZvcmVcclxuICAgICAgICAgICAgc2VsZWN0ZWRUZXh0OiBzdHJpbmcsXHJcbiAgICAgICAgICAgIHNlbGVjdGlvblN0YXJ0OiBudW1iZXIsXHJcbiAgICAgICAgICAgIHNlbGVjdGlvbkVuZDogbnVtYmVyLFxyXG4gICAgICAgICAgICBhbGxUZXh0OiBzdHJpbmc7XHJcblxyXG4gICAgICAgIGlmIChlLmtleSA9PT0gXCJUYWJcIikge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICBzZWxlY3Rpb25TdGFydCA9IHRoaXMuc2VsZWN0aW9uU3RhcnQ7XHJcbiAgICAgICAgICAgIHNlbGVjdGlvbkVuZCA9IHRoaXMuc2VsZWN0aW9uRW5kO1xyXG4gICAgICAgICAgICBzZWxlY3RlZFRleHQgPSB0aGlzLnZhbHVlLnN1YnN0cmluZyhzZWxlY3Rpb25TdGFydCwgc2VsZWN0aW9uRW5kKTtcclxuICAgICAgICAgICAgYWxsVGV4dCA9IHRoaXMudmFsdWU7XHJcblxyXG4gICAgICAgICAgICBpZiAofnNlbGVjdGVkVGV4dC5pbmRleE9mKCdcXG4nKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFRleHQgPSBzZWxlY3RlZFRleHQuc3BsaXQoJ1xcbicpLm1hcChmdW5jdGlvbihlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWwuc3Vic3RyKDAsVEFCX0NIQVIubGVuZ3RoKSA9PSBUQUJfQ0hBUikgcmV0dXJuIGVsLnN1YnN0cig0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oJ1xcbicpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gYWxsVGV4dC5zdWJzdHIoMCwgc2VsZWN0aW9uU3RhcnQpICsgc2VsZWN0ZWRUZXh0ICsgYWxsVGV4dC5zdWJzdHIoc2VsZWN0aW9uRW5kKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUZXh0ID0gc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5tYXAoZnVuY3Rpb24oZWwpIHsgcmV0dXJuIFRBQl9DSEFSICsgZWwgfSkuam9pbignXFxuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFsbFRleHQuc3Vic3RyKDAsIHNlbGVjdGlvblN0YXJ0KSArIHNlbGVjdGVkVGV4dCArIGFsbFRleHQuc3Vic3RyKHNlbGVjdGlvbkVuZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TdGFydCA9IHNlbGVjdGlvblN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25FbmQgPSBzZWxlY3Rpb25TdGFydCtzZWxlY3RlZFRleHQubGVuZ3RoO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWxsVGV4dC5zdWJzdHIoc2VsZWN0aW9uU3RhcnQtVEFCX0NIQVIubGVuZ3RoLCBUQUJfQ0hBUi5sZW5ndGgpID09IFRBQl9DSEFSKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBhbGxUZXh0LnN1YnN0cigwLCBzZWxlY3Rpb25TdGFydC1UQUJfQ0hBUi5sZW5ndGgpICsgYWxsVGV4dC5zdWJzdHIoc2VsZWN0aW9uRW5kKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uRGVsdGEgPSAtVEFCX0NIQVIubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFsbFRleHQuc3Vic3RyKDAsIHNlbGVjdGlvblN0YXJ0KSArIFRBQl9DSEFSICsgYWxsVGV4dC5zdWJzdHIoc2VsZWN0aW9uRW5kKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25EZWx0YSA9IFRBQl9DSEFSLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblN0YXJ0ID0gdGhpcy5zZWxlY3Rpb25FbmQgPSBzZWxlY3Rpb25TdGFydCArIHNlbGVjdGlvbkRlbHRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIiQyZjg4MGE1YjJjZDU1NWQxJGV4cG9ydCQ2NTAzZWM2ZThhYWJiYWYiLCIkMmY4ODBhNWIyY2Q1NTVkMSRleHBvcnQkZjdhZDAzMjg4NjFlMmYwMyIsIiQyZjg4MGE1YjJjZDU1NWQxJHZhciRtYXBwaW5nIiwicGFpcnMiLCJrZXlzIiwiT2JqZWN0IiwiaSIsImxlbmd0aCIsImlkIiwicmVzb2x2ZWQiLCJFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJwYXJjZWxSZXF1aXJlIiwiZ2V0QnVuZGxlVVJMIiwicmVzb2x2ZSIsIiRlMWNhY2I4NzMyYWM5MDA2JGV4cG9ydCRiZGZkNzA5YWU0ODI2Njk3IiwiJGUxY2FjYjg3MzJhYzkwMDYkdmFyJGJ1bmRsZVVSTCIsIiRlMWNhY2I4NzMyYWM5MDA2JHZhciRnZXRCYXNlVVJMIiwidXJsIiwicmVwbGFjZSIsInZhbHVlIiwiZXJyIiwibWF0Y2hlcyIsInN0YWNrIiwibWF0Y2giLCIkZTFjYWNiODczMmFjOTAwNiR2YXIkZ2V0QnVuZGxlVVJMIiwicmVnaXN0ZXIiLCJKU09OIiwicGFyc2UiLCIkYkp1VUYiLCJjb25zb2xlIiwibG9nIiwiJDFmYmIwMDljZDIwNzFlZDMkdmFyJGN1cnJlbnRseUVucmljaGVkIiwiV2Vha01hcCIsIiQxZmJiMDA5Y2QyMDcxZWQzJHZhciRyZW1vdmVJbmRlbnRhdGlvbkVucmljaG1lbnQiLCJ0ZXh0QXJlYSIsInByZXhpc3RpbmdMaXN0ZW5lciIsImdldCIsInVuZGVmaW5lZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJkZWxldGUiLCIkMWZiYjAwOWNkMjA3MWVkMyR2YXIkZ2V0SW5pdGlhbEF0dHJpYnV0ZXMiLCJnZXRBdHRyaWJ1dGUiLCJzcGVsbGNoZWNrIiwiJDFmYmIwMDljZDIwNzFlZDMkdmFyJHRleHRBcmVhcyIsIk1hcCIsIiQxZmJiMDA5Y2QyMDcxZWQzJHZhciRyZW1vdmVPdmVybGF5IiwicmVtb3ZlUGVybWVuYW50bHkiLCIkMWZiYjAwOWNkMjA3MWVkMyR2YXIkaGFuZGxlT3ZlcmxheUNsaWNrIiwiJDFmYmIwMDljZDIwNzFlZDMkdmFyJGhhbmRsZU92ZXJsYXlLZXlEb3duIiwiJDdzOUhMIiwiY29tcGF0aWJsZVN0b3JhZ2UiLCJzeW5jIiwic2V0Iiwid2VsY29tZU1lc3NhZ2VEaXNtaXNzZWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJpbml0aWFsQXR0cmlidXRlcyIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsIndhcm4iLCIkMWZiYjAwOWNkMjA3MWVkMyR2YXIkcmVzdG9yZUluaXRpYWxBdHRyaWJ1dGVzIiwiZXZlbnQiLCJ0aGlzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJwcmVleGlzdGluZ1RleHRBcmVhIiwiTXV0YXRpb25PYnNlcnZlciIsIm11dGF0aW9ucyIsIm11dGF0aW9uIiwidGFyZ2V0Iiwibm9kZSIsIm5vZGVUeXBlIiwiTm9kZSIsIkVMRU1FTlRfTk9ERSIsIm5ld1RleHRFbGVtZW50cyIsIkFycmF5IiwiZnJvbSIsIm5ld1RleHRBcmVhIiwibmFtZSIsInBsYWNlaG9sZGVyIiwiY2xvc2VzdCIsIiQxZmJiMDA5Y2QyMDcxZWQzJHZhciRhcHBseURvbU1vZGlmaWNhdGlvbnMiLCIkMWZiYjAwOWNkMjA3MWVkMyR2YXIkc3RvcmFnZVN0YXRlIiwiZXhpc3RpbmdTdGF0ZSIsIm1lc3NhZ2UiLCJ0eXBlIiwiZnVuY3Rpb25hbGl0eURpc2FibGVkIiwiYnJvd3NlciIsImNocm9tZSIsInJ1bnRpbWUiLCJzZW5kTWVzc2FnZSIsIl90ZXh0QXJlYUJvcmRlckVuYWJsZWQiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwib25jZSIsInRleHRBcmVhQm9yZGVyRW5hYmxlZCIsInRhYkxlbmd0aCIsImxpc3RlbmVyIiwibnVtYmVyT2ZTcGFjZXNQZXJUYWIiLCJlIiwic2VsZWN0ZWRUZXh0Iiwic2VsZWN0aW9uU3RhcnQiLCJzZWxlY3Rpb25FbmQiLCJhbGxUZXh0IiwiVEFCX0NIQVIiLCJyZXBlYXQiLCJzZWxlY3Rpb25EZWx0YSIsImtleSIsInN0b3BQcm9wYWdhdGlvbiIsInByZXZlbnREZWZhdWx0Iiwic3Vic3RyaW5nIiwiaW5kZXhPZiIsInNoaWZ0S2V5Iiwic3BsaXQiLCJtYXAiLCJlbCIsInN1YnN0ciIsImpvaW4iLCIkMWZiYjAwOWNkMjA3MWVkMyR2YXIkZW5yaWNoV2l0aEluZGVudGF0aW9uIiwic3R5bGVTdHJpbmciLCJzdHlsZSIsIiQxZmJiMDA5Y2QyMDcxZWQzJHZhciRjb21wYXRpYmxlR2V0VVJMIiwicGF0aE9yVXJsIiwiZ2V0VVJMIiwiJDFmYmIwMDljZDIwNzFlZDMkdmFyJHRleHRBcmVhT3ZlcmxheVVybCIsIiQxZmJiMDA5Y2QyMDcxZWQzJHZhciR0ZXh0QXJlYU92ZXJsYXlIb3ZlclVybCIsImNvbmNhdCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImhlYWQiLCJhcHBlbmQiLCIkcGFyY2VsJGludGVyb3BEZWZhdWx0IiwiJDdValBBIiwid3JhcCIsIl9jdHgiLCJwcmV2IiwibmV4dCIsImluaXRpYWxTdG9yYWdlU3RhdGUiLCJfdmFsdWUiLCIkN0ZtZTQiLCJkZWZhdWx0IiwiX3N0ZXAiLCJwcm9wZXJ0eSIsImNoYW5nZSIsImFsbENoYW5nZXMiLCJuZXdWYWx1ZSIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2l0ZXJhdG9yIiwicmV0dXJuIiwiJDdsNmVqIiwiYXBwbHkiLCJhcmd1bWVudHMiXSwidmVyc2lvbiI6MywiZmlsZSI6ImNvbnRlbnRfc2NyaXB0LkhBU0hfUkVGXzZjMTVkNTQzNzc4ZTZkNjkuanMubWFwIn0=
